<!DOCTYPE html><html><head><title>R: Secure ranking of a vector across all sources and use of...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="../../assets/R.css" />
</head><body><div class="container">

<table width="100%"><tr><td>ds.extractQuantiles {dsBaseClient}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Secure ranking of a vector across all sources and use of these ranks
to estimate global quantiles across all studies</h2>

<h3>Description</h3>

<p>Takes the global ranks and quantiles held in the serverside data
data frame that is written by ranksSecureDS4 and named as specified by the
argument (&lt;output.ranks.df&gt;) and converts these values into a series of
quantile values that identify, for example, which value of V2BR across all of
the studies corresponds to the median or to the 95
indication in which study the V2BR corresponding to a particular quantile
falls and, in fact, the relevant value may fall in more than one study and
may appear multiple times in any one study. Finally, the output data
frame containing this information is written to the clientside and to the
serverside at each study separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ds.extractQuantiles(
  extract.quantiles,
  extract.summary.output.ranks.df,
  extract.ranks.sort.by,
  extract.rm.residual.objects,
  extract.datasources = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr valign="top"><td><code>extract.quantiles</code></td>
<td>
<p>one of a restricted set of character strings.
The value of this argument is set in choosing the value of the argument
&lt;quantiles.for.estimation&gt; in ds.ranksSecure. In summary: to mitigate
disclosure risk only the following set of quantiles can be
generated: c(0.025,0.05,0.10,0.20,0.25,0.30,0.3333,0.40,0.50,0.60,0.6667,
0.70,0.75,0.80,0.90,0.95,0.975). The allowable formats for the argument
are of the general form: &quot;0.025-0.975&quot; where the first number is the lowest
quantile to be estimated and the second number is the equivalent highest 
quantile to estimate. These two quantiles are then estimated along with
all allowable quantiles in between. The allowable argument values are then:
&quot;0.025-0.975&quot;, &quot;0.05-0.95&quot;, &quot;0.10-0.90&quot;, &quot;0.20-0.80&quot;. Two alternative values
are &quot;quartiles&quot; i.e. c(0.25,0.50,0.75), and &quot;median&quot; i.e. c(0.50). The
default value is &quot;0.05-0.95&quot;. For more details, see the associated document
&quot;secure.global.ranking.docx&quot;. Also see the header file for ds.ranksSecure.</p>
</td></tr>
<tr valign="top"><td><code>extract.summary.output.ranks.df</code></td>
<td>
<p>a character string which specifies 
the optional name for the summary data.frame written to the serverside on
each data source that contains 5 of the key output variables from the ranking
procedure pertaining to that particular data source. If no name has been
specified by the argument &lt;summary.output.ranks.df&gt; in ds.ranksSecure, the
default name is allocated as &quot;summary.ranks.df&quot;.The only reason the
&lt;extract.summary.output.ranks.df&gt; argument needs specifying in
ds.extractQuantiles is because, ds.extractQuantiles is the last function
called by ds.ranksSecure and almost the final command of ds.extractQuantiles
to print out the name of the data frame containing the summarised ranking
information generated by ds.ranksSecure and the order in which the
data frame is laid out. This therefore appears as the last output produced 
when ds.ranksSecure is run, and when this happens it is clear this relates to
the main output of ds.ranksSecure not of ds.extractQuantiles.</p>
</td></tr>
<tr valign="top"><td><code>extract.ranks.sort.by</code></td>
<td>
<p>a character string taking two possible values.
These are &quot;ID.orig&quot; and &quot;vals.orig&quot;. This is set via the argument
&lt;ranks.sort.by&gt; in ds.ranksSecure. For more details see the associated
document entitled &quot;secure.global.ranking.docx&quot;. Also see the header
file for ds.ranksSecure.</p>
</td></tr>
<tr valign="top"><td><code>extract.rm.residual.objects</code></td>
<td>
<p>logical value. Default = TRUE: at the beginning
and end of each run of ds.ranksSecure delete all extraneous objects that are
otherwise left behind. These are not usually needed, but could be of value
if one were investigating a problem with the ranking. FALSE: do not delete
the residual objects</p>
</td></tr>
<tr valign="top"><td><code>extract.datasources</code></td>
<td>
<p>specifies the particular opal object(s) to use.
This is set via the argument&lt;datasources&gt; in ds.ranksSecure. For more details
see the associated document entitled &quot;secure.global.ranking.docx&quot;. Also see
the header file for ds.ranksSecure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ds.extractQuantiles is a clientside function which should usually
be called from within the clientside function ds.ranksSecure.If you try to
call ds.extractQuantiles directly(i.e. not by running ds.ranksSecure) you
are almost certainly going to have to set up quite a few vectors and scalars
that are normally set by ds.ranksSecure and this is likely to be difficult. 
ds.extractQuantiles itself calls two serverside functions extractQuantilesDS1
and extractQuantilesDS2. For more details about the cluster of functions that
collectively enable secure global ranking and estimation of global quantiles
see the associated document entitled &quot;secure.global.ranking.docx&quot;. In
particular this explains how ds.extractQuantiles works. Also see the header
file for ds.ranksSecure.
</p>


<h3>Value</h3>

<p>the final main output of ds.extractQuantiles is a data frame object
named &quot;final.quantile.df&quot;. This contains two vectors. The first named 
&quot;evaluation.quantiles&quot; lists the full set of quantiles you have requested
for evaluation as specified by the argument &quot;quantiles.for.estimation&quot; in
ds.ranksSecure and explained in more detail above under the information for
the argument &quot;extract.quantiles&quot; in this function. The second vector is
called &quot;final.quantile.vector&quot; which details the values of V2BR that
correspond to the evaluation quantiles in vector 1. The information in the
data frame &quot;final.quantile.df&quot; is generic: there is no information
identifying in which study each value of V2BR falls. This data frame is
written to the clientside (as it is non-disclosive) and is also copied to
the serverside in every study. This means it is easily accessible from
anywhere in the DataSHIELD environment. For more details
see the associated document entitled &quot;secure.global.ranking.docx&quot;.
</p>


<h3>Author(s)</h3>

<p>Paul Burton 11th November, 2021
</p>

<hr /><div style="text-align: center;">[Package <em>dsBaseClient</em> version 6.3.0 ]</div>
</div>
</body></html>
